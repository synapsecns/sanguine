name: 'Close stale issues, branches and PRs'
on:
  schedule:
    - cron: '30 1 * * *'
  workflow_dispatch:
  push:
    paths:
      - '.github/workflows/close-stale.yml'

jobs:
  stale-prs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v8
        with:
          stale-pr-message: 'This PR is stale because it has been open 14 days with no activity. Remove stale label or comment or this will be closed in 5 days.'
          exempt-pr-labels: exempt-stale
          days-before-issue-stale: 999
          days-before-pr-stale: 14
          days-before-close: 5
          repo-token: ${{ secrets.GITHUB_TOKEN }}
  stale-branches:
    name: Remove Stale Branches
    runs-on: ubuntu-latest
    steps:
      # TODO: enable
      - uses: fpicalausa/remove-stale-branches@v1
        with:
          dry-run: true # Check out the console output before setting this to false
